---
title: "Analisis de dataset: Youtube Trending Video Dataset"
author: "Mauricio Campos, Jonathan Jara y Sebastián Pardo"
date: "8 de Abril de 2022"
output:
  html_document:
    theme: default
    toc: yes
    df_print: paged
---

# Introducción

De acuerdo con Google "la pestaña de tendencias de YouTube permite que los usuarios descubran las novedades de YouTube" [1]. Esta es una lista común compuesta de videos actuales que se muestra a todos los usuarios de un mismo país. YouTube mantiene listas de tendencias diferentes para cada país, las cuales actualiza con una frecuencia de 15 minutos. Si bien Google no ha hecho público el método para calcular las listas de tendencias, ha comunicado que buscan seleccionar videos que representen la actualidad de YouTube y sean relevantes para los usuarios del país correspondiente. Algunos de los factores que tienen en cuenta son:

-   La cantidad de tiempo que lleva el video en la plataforma.
-   Las visitas del video.
-   El lugar o página web del que provienen las visitas.
-   La rapidez con la que el video acumula visitas.
-   El rendimiento del video en comparación a videos anteriores del mismo canal.

En base a estos criterios, es posible que se encuentren videos con bajas visitas en posiciones altas de la lista, si estas se comparan con otros videos de la misma lista.

El conjunto de datos seleccionado, [**YouTube Trending Video Dataset (updated daily)**](https://www.kaggle.com/datasets/rsrishav/youtube-trending-video-dataset/versions/610) contiene la información de estas listas de tendencias de 11 países: Brasil, Canadá, Alemania, Francia, Gran Bretaña, India, Japón, Corea del sur, México, Rusia y Estados Unidos. Algunos de los datos que incluye son el título del video, la fecha de subida del video, la cantidad de likes y de visitas, etc. El conjunto de datos es actualizado con una frecuencia diaria y se agregan hasta 200 videos nuevos en las listas de tendencias por día. Se utilizará la versión 610 del conjunto de datos, la cual contiene datos actualizados hasta el día 7 de Abril de 2022.

El creador de este conjunto de datos propone algunos usos:

-   Análisis de sentimientos.
-   Categorizar los videos basados en sus comentarios o estadísticas.
-   Entrenar algoritmos de Machine Learning para generar comentarios.
-   Analizar que factores afectan a la popularidad de un video.
-   Análisis estadísticos a lo largo del tiempo.

Añadiendo a estas propuestas, puede resultar interesante el estudio de estos datos para encontrar todo tipo de relaciones entre los datos de cada video y el entorno de YouTube, por ejemplo:

-   Determinar factores diferenciadores y comunes en las portadas de los videos en tendencia.
-   Identificar los tópicos que mejor funcionan para un tema específico (salud, deporte, juegos, etc.).
-   Encontrar nichos de contenido que estén en crecimiento.
-   Estudiar las mejores formas de estructurar el título de un video para aumentar las visualizaciones.
-   Identificar las preferencias de cada país respecto del contenido consumido.

Otra área que resulta interesante explorar es automatizar la generación de alguno de los atributos del conjunto de datos, como la miniatura, el título o la descripción. Finalmente, la predicción del rendimiento de un video (visualizaciones, likes, dislikes) es otra razón que hace interesante el estudio de este conjunto de datos.

# Análisis exploratorio del conjunto de datos

Los datos a analizar corresponden a los trendings de YouTube para el país de México, separado en dos dataset, uno que corresponde al principal, y un segundo dataset con información de las categorías disponibles para cada video.

Se comenzará cargando el dataset principal a un dataframe:

```{r}
mx_dataset <- read.csv("./dataset/MX_youtube_trending_data.csv", encoding = "UTF-8")
head(mx_dataset, n = 20)
```

Las dimensiones del dataset son, 121.399 filas y 16 columnas.

```{r}
dim(mx_dataset)
```

Una versión resumida del dataset se encuentra a continuación, en este resumen se indican:

-   Cantidad de items en la columna.

-   La clase y el modo de los valores de la columna.

-   Si la columna es de clase tipo numérico entrega valores estadísticos como: valor mínimo y máximo, la media y mediana, y los cuartiles 1 y 3.

```{r}
summary(mx_dataset)
```

El dataset usado, en ocasión del primer hito, corresponde a *mx_dataset*, el cual encapsula los videos más tendenciosos de YouTube en la región de México. Este dataset contiene, 121399 filas de información, dónde cada fila corresponde a los datos de un video que fue considerado para su captura debido a que estuvo en tendencia en algún momento de su existencia. Las columnas del dataset corresponde a:

```{r}
unique(mx_dataset)
```

-   video_id (la id única de cada video en YouTube que se encuentra después de www.youtube.com/watch?)
-   title (el título del video)
-   publishedAt (la marca de tiempo cuando fue subido el video a la plataforma)
-   chanelId (identificador único del canal por el cual fue subido el video)
-   channelTitle (el nombre del canal dónde fue subido el video)
-   categoryId (identificador de la categoría a la cual pertenece el video)
-   trending_date (fecha en la cual el video estuvo en tendencia en YouTube)
-   tags (etiquetas ingresadas por el usuario que subió el video para identificarlo)
-   view_count (cantidad de vistas acumuladas el video)
-   likes (cantidad de "me gusta" del video)
-   dislikes (cantidad de no me gustas del video)
-   comment_count (cantidad de comentarios acumulados por el video)
-   thumbnail_link (link de la imagen de miniatura del video)
-   comments_disabled (booleano que identifica si la posibilidad de escribir comentarios en el video se encuentra disponible)
-   ratings_disabled (booleano que muestra si la habilidad de darle me gusta o no me gusta al video se encuentra disponible)
-   description (descripción del video escrita por el usuario que lo subió).

A continuación se cargará el segundo dataset de categorías:

```{r}
library(jsonlite)
mx_list_categories <- fromJSON("./dataset/MX_category_id.json")
mx_categories <- data.frame(mx_list_categories)
head(mx_categories, n= 20)
```

El archivo MX_category_id contiene cada categoría (categoryId) a la cual puede pertenecer cada video. Las columnas de este archivo son las siguientes:

-   kind (La clase correspondiente al dato, en este caso fijada a "youtube#videoCategoryListResponse")
-   etag (Texto que corresponde al http etag de este recurso)
-   id (Texto, la identificación única que YouTube usa para identificar la categoría)
-   snippet (Detalles básicos de la categoría en cuestión)
-   title (Descripción de la categoría)
-   assignable (Valor booleano que denota si la categoría puede ser asiganda)
-   channelId (Identificador del canal único que YouTube otorga a esta categoría)

Las dimensiones de este dataset son, 31 filas y 6 columnas.

```{r}
dim(mx_categories)
```

La columna *items.snippet* del dataset de categorías es de tipo *data.frame*, es decir, cada fila del conjunto contiene otro *data.frame* en el valor de la columna *items.snippet*.

```{r}
class(mx_categories$items.snippet)
head(mx_categories$items.snippet)
```

Existen un total de 30 categorías, estas son:

```{r}
unique(mx_categories$items.snippet$title)
```

El dataset *mx_dataset* contiene valores nulos o en blanco en las columna *description* y *tags*. Se encontraron 6819 valores faltantes en la columna *description* y 20407 en la columna *tags*.

```{r}
null_values_dataset <- sapply(mx_dataset, function(x) is.na(x) | x == "" | x == "[None]")
colSums(null_values_dataset)
```

El dataset *mx_categories* no contiene valores nulos o en blanco en ninguna de sus columnas. Esto incluye las columnas que se encuentran dentro del dataframe de la columna *items.snippet*.

```{r}
sapply(mx_categories, function(x) any(is.na(x) | x == ""))
```

------------------------------------------------------------------------

## Cantidad de videos por categoria

La cantidad de videos que tiene cada categoría para el dataset de México se presenta en el siguiente gráfico:

```{r}
library(ggplot2)
aux_categories <- data.frame(categoryId = mx_categories$items.id , categoryTitle = mx_categories$items.snippet$title)
mx_categories <- merge(mx_dataset, aux_categories)

ggplot(mx_categories, aes(x = categoryTitle)) +
  geom_bar(stat = 'count') +
  coord_flip() +
  xlab("Categoria") + ylab("Cantidad de videos")
```

## Cantidad de likes, dislikes y comentarios

Dentro del análisis exploratorio de los datos se contempla un análisis sobre los likes, dislikes y comentarios para el dataset de trendings de México.

### Visitas vs likes

La cantidad de las visitas vs likes se presenta en el siguiente gráfico de disperción:


```{r}
ggplot(mx_dataset, aes(x = view_count, y = likes)) +
  geom_point() +
  xlab("Cantidad de visitas") + ylab("Cantidad de likes")
```

### Visitas vs dislikes

La cantidad de las visitas vs dislikes se presenta en el siguiente gráfico de disperción: 


```{r}
ggplot(mx_dataset, aes(x = view_count, y = dislikes)) +
  geom_point() +
  xlab("Cantidad de visitas") + ylab("Cantidad de dislikes")
```

### Visitas vs comentarios

La cantidad de visitas vs cantidad de comentarios se presenta de la siguiente manera:

```{r}
ggplot(mx_dataset, aes(x = view_count, y = comment_count)) +
  geom_point() +
  xlab("Cantidad de visitas") + ylab("Cantidad de comentarios")
```

## Comparativa de canales

A continuación se realizará un análisis a los 10 canales con mayor cantidad de videos en la lista de trendings para el dataset de trendings de México.

### Videos en la lista de trendings

Gráfico de top 10 canales con mas videos en la lista de trendings:

```{r}
library(tidyverse)
top_10 <- group_by(mx_dataset, channelTitle) |>
  summarize(Freq = n()) |>
  arrange(desc(Freq)) |>
  top_n(10)

top_10

ggplot(top_10, aes(x = reorder(channelTitle, Freq), y = Freq)) +
  geom_bar(stat = 'identity') +
  coord_flip() +
  xlab('Canal de YouTube') +
  ylab('Cantidad de videos en trendings')
```

### Likes y dislikes de videos en trendings

Gráfico de acumulacion de cantidad de likes y dislikes del top 10 canales con mas videos en trendings:

```{r fig.width = 8}
library(gridExtra)
library("scales")
top_10_accumulations <- group_by(mx_dataset, channelTitle) |>
  summarize(Freq = n(), likes = sum(likes), dislikes = sum(dislikes)) |>
  arrange(desc(Freq)) |>
  top_n(10, Freq)

likes_plot <- ggplot(top_10_accumulations,aes(x = reorder(channelTitle, Freq),y = likes)) + 
  geom_bar(stat = 'identity') + 
  coord_flip() +
  scale_y_continuous(labels = scales::comma, breaks = c(0, 245000000, 490000000, 735000000, 980000000)) +
  xlab("Canal") + ylab("Cantidad de likes")

dislikes_plot <- ggplot(top_10_accumulations,aes(x = reorder(channelTitle, Freq),y = dislikes)) + 
  geom_bar(stat = 'identity') + 
  coord_flip() +
  scale_y_continuous(labels = scales::comma) +
  xlab("Canal") + ylab("Cantidad de dislikes")


grid.arrange(likes_plot, dislikes_plot)
```

### Mayor cantidad de likes

Gráfico de top 10 canales con mayor acumulación de likes:

```{r}

likes_accumulation <- group_by(mx_dataset, channelTitle) |>
  summarize(Accumulation = sum(likes)) |>
  arrange(desc(Accumulation)) |>
  top_n(10)

ggplot(likes_accumulation, aes(x = reorder(channelTitle, Accumulation), y = Accumulation)) +
  geom_bar(stat = 'identity') +
  coord_flip() +
  xlab('Canal de YouTube') +
  ylab('Cantidad de videos en trendings')
```

### Matriz de correlación

Matriz de correlación entre columnas para el dataset de trendings de México.

```{r}
library(corrplot)

mx_dataset$comments_disabled <- as.numeric(as.logical(mx_dataset$comments_disabled))
mx_dataset$ratings_disabled <- as.numeric(as.logical(mx_dataset$ratings_disabled))

numeric_mx_dataset <- Filter(is.numeric, mx_dataset)
numeric_mx_dataset.cor <- cor(numeric_mx_dataset)
corrplot(numeric_mx_dataset.cor, method = 'number')
```

```{r}
mx_dataset <- read.csv("./dataset/MX_youtube_trending_data.csv", encoding = "UTF-8")
mx_dataset$country <- "MX"
us_dataset <- read.csv("./dataset/US_youtube_trending_data.csv", encoding = "UTF-8")
us_dataset$country <- "US"
br_dataset <- read.csv("./dataset/BR_youtube_trending_data.csv", encoding = "UTF-8")
br_dataset$country <- "BR"
ca_dataset <- read.csv("./dataset/CA_youtube_trending_data.csv", encoding = "UTF-8")
ca_dataset$country <- "CA"
de_dataset <- read.csv("./dataset/DE_youtube_trending_data.csv", encoding = "UTF-8")
de_dataset$country <- "DE"
fr_dataset <- read.csv("./dataset/FR_youtube_trending_data.csv", encoding = "UTF-8")
fr_dataset$country <- "FR"
gb_dataset <- read.csv("./dataset/GB_youtube_trending_data.csv", encoding = "UTF-8")
gb_dataset$country <- "BG"
in_dataset <- read.csv("./dataset/IN_youtube_trending_data.csv", encoding = "UTF-8")
in_dataset$country <- "IN"
jp_dataset <- read.csv("./dataset/JP_youtube_trending_data.csv", encoding = "UTF-8")
jp_dataset$country <- "JP"
kr_dataset <- read.csv("./dataset/KR_youtube_trending_data.csv", encoding = "UTF-8")
kr_dataset$country <- "KR"
ru_dataset <- read.csv("./dataset/RU_youtube_trending_data.csv", encoding = "UTF-8")
ru_dataset$country <- "RU"

dataset <- rbind(mx_dataset, us_dataset, br_dataset, ca_dataset, de_dataset, fr_dataset, gb_dataset, in_dataset, jp_dataset, kr_dataset, ru_dataset)


```

## Análisis comparativo con los demás paises

Si bien el análisis exploratorio inicial se realizó tomando el dataset correspondiente a México, existen muchos otros paises dentro del dataset de trendings de Youtube, por lo cual se realizan algunos análisis generales a continuación.

## Cantidad de videos en trending por pais

La cantidad de videos en trending por cada pais se presenta en el siguiente gráfico:

```{r}

videos_amount <- group_by(dataset, country) |>
  summarize(amount = n())

ggplot(videos_amount, aes(x = country, y = amount)) +
  geom_bar(stat = 'identity') +
  scale_y_continuous(labels = scales::comma) +
  coord_flip() +
  xlab("Pais") + ylab("Cantidad de videos")
```

## Cantidad de visitas por pais

La cantidad de visitas de todos los videos en la lista de trendings por pais se presenta en el siguiente gráfico:

```{r}

view_count <- group_by(dataset, country) |>
  summarize(views = sum(view_count))

ggplot(view_count, aes(x = country, y = views)) +
  geom_bar(stat = 'identity') +
  scale_y_continuous(labels = scales::comma) +
  xlab("Pais") + ylab("Cantidad de visitas")
```

------------------------------------------------------------------------

# Preguntas y problemas

# Repositorio GitHub

El proyecto se documenta en un repositorio de GitHub, donde se podrá acceder en el siguiente link:

[Repositorio de Github](https://github.com/Jjaraa/yt-trending)

# Referencias

[1] <https://support.google.com/youtube/answer/7239739?hl=es-419>
